<app-header></app-header>

<section class="cart-container">

  <h2 class="page-title">Your Cart</h2>

  <!-- FILTER BAR -->
  <div class="filter-bar">
    <select [(ngModel)]="selectedSize" (change)="applyFilters()">
      <option value="">All Sizes</option>
      <option *ngFor="let s of allSizes" [value]="s">{{ s }}</option>
    </select>

    <select [(ngModel)]="priceSort" (change)="applyFilters()">
      <option value="">Sort by Price</option>
      <option value="low">Low → High</option>
      <option value="high">High → Low</option>
    </select>
  </div>

  <div class="cart-grid" *ngIf="filteredItems.length; else empty">

    <!-- LEFT : CART ITEMS -->
    <div class="cart-items">
      <div class="cart-card" *ngFor="let p of filteredItems">
        <img [src]="p.img" />

        <div class="details">
          <h4>{{ p.title }}</h4>
          <p class="price">₹{{ p.price }}</p>
          <p class="size">Size: {{ p.size.join(', ') }}</p>

          <div class="qty">
            <button (click)="updateQty(p,-1)">−</button>
            <span>{{ p.qty }}</span>
            <button (click)="updateQty(p,1)">+</button>
          </div>

          <div class="actions">
            <button class="link" (click)="saveForLater(p)">Save for later</button>
            <button class="danger" (click)="remove(p.id)">Remove</button>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT : ORDER SUMMARY -->
    <div class="summary">

      <h3>Order Summary</h3>

      <!-- PROMO -->
      <div class="promo">
        <input type="text" [(ngModel)]="couponCode" placeholder="Promo code">
        <button (click)="applyCoupon()">Apply</button>
      </div>

      <div class="row">
        <span>MRP</span>
        <span>₹{{ priceSummary.mrp }}</span>
      </div>

      <div class="row green">
        <span>Discount</span>
        <span>- ₹{{ priceSummary.discount }}</span>
      </div>

      <div class="row">
        <span>Tax (18%)</span>
        <span>₹{{ priceSummary.tax }}</span>
      </div>

      <div class="row">
        <span>Shipping</span>
        <span>₹{{ priceSummary.shipping }}</span>
      </div>

      <hr>

      <div class="row total">
        <span>Total</span>
        <span>₹{{ priceSummary.total | number:'1.0-2' }}</span>
      </div>

      <!-- CHECKOUT -->
      <button class="checkout-btn" (click)="checkout()">
        Proceed to Checkout
      </button>

      <p class="guest">Guest checkout available</p>
    </div>

  </div>

  <ng-template #empty>
    <p class="empty">Your cart is empty.</p>
  </ng-template>

</section>

<app-footer></app-footer>
